<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>길음한의원 | 인슐린 저항성 자가진단</title>
    <meta name="description" content="길음한의원에서 제공하는 인슐린 저항성 자가진단 테스트. 식후 피로감, 복부비만, 만성피로 등 내 몸의 상태를 확인하고 한의학적 원인과 관리법까지 알아보세요.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #fbf9f4;
            color: #3b3b3b;
        }
        .header {
            text-align: center;
            padding: 20px 10px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        .container {
            background: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            max-width: 800px;
            margin: 30px auto;
        }
        h1, h2, h3, h4, h5 { color: #3b3b3b; }
        h1 { text-align: center; color: #5a6e5a; margin-bottom: 25px; }
        .section-title { font-size: 1.6em; color: #5a6e5a; border-bottom: 2px solid #5a6e5a; padding-bottom: 8px; margin-top: 35px; margin-bottom: 25px; }
        
        /* 기본 버튼 스타일 */
        button, .btn {
            color: white;
            padding: 14px 22px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease;
            display: block;
            width: 100%;
            margin-top: 20px;
            box-sizing: border-box;
            text-align: center;
        }
        #analyzeBtn { background-color: #5a6e5a; }
        #analyzeBtn:hover { background-color: #4a5c4a; }

        /* ▼▼▼▼▼ 새로 추가된 버튼들을 위한 스타일 ▼▼▼▼▼ */
        .action-buttons {
            margin-top: 30px;
            display: flex;
            gap: 15px; /* 버튼 사이 간격 */
            justify-content: center;
        }
        .action-buttons .btn {
            width: auto;
            flex-grow: 1; /* 버튼이 공간을 균등하게 차지 */
            padding: 12px 20px;
            font-size: 1em;
            text-decoration: none;
        }
        .btn-gohome {
            background-color: #5a6e5a; /* 홈페이지로 가기 버튼 (진한 녹색) */
            color: #ffffff;
            border: 1px solid #5a6e5a;
        }
        .btn-reset {
            background-color: #ffffff; /* 다시 검사하기 버튼 (흰색) */
            color: #5a6e5a;
            border: 1px solid #5a6e5a;
        }
        /* ▲▲▲▲▲ 여기까지 추가 ▲▲▲▲▲ */

        #results { margin-top: 30px; padding: 25px; background-color: #f7f7f7; border-left: 6px solid #5a6e5a; border-radius: 5px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #495057; }
        input[type="text"], input[type="number"], select { width: 100%; padding: 12px; margin-bottom: 18px; border: 1px solid #ced4da; border-radius: 5px; box-sizing: border-box; font-size: 1em; }
        input[type="checkbox"] { margin-right: 10px; vertical-align: middle; }
        .checkbox-group label { font-weight: normal; display: inline-block; margin-bottom: 10px; cursor: pointer; }
        #results ul { padding-left: 20px; list-style: disc; }
        .warning { color: #856404; font-weight: bold; margin-bottom: 20px; padding: 15px; background-color: #fff3cd; border: 1px solid #ffeeba; border-radius: 5px; text-align: center; }
        .risk-low { color: #28a745; font-weight: bold; }
        .risk-moderate { color: #fd7e14; font-weight: bold; }
        .risk-high { color: #dc3545; font-weight: bold; }
        .required-mark { color: #dc3545; margin-left: 3px;}
    </style>
</head>
<body>

<div class="header">
    <a href="https://goodnewshani.my.canva.site/">
        <img src="https://i.imgur.com/P1A4g62.png" alt="길음한의원 로고" style="max-height: 40px;">
    </a>
</div>

<div class="container">
    <h1>인슐린 저항성 자가 테스트</h1>
    <p class="warning"><strong>주의:</strong> 이 설문은 의학적 진단을 대체할 수 없으며, 참고용으로만 사용해주십시오. 건강 문제나 우려 사항이 있으시면 반드시 <strong>한의사 또는 의사</strong>와 상담하시기 바랍니다.</p>
    
    <form id="insulinSurvey">
        <h2 class="section-title">기본 정보</h2>
        <div><label for="age">나이 (세)<span class="required-mark">*</span>:</label><input type="number" id="age" name="age" required></div>
        <div><label for="height">키 (cm)<span class="required-mark">*</span>:</label><input type="number" id="height" name="height" step="0.1" required></div>
        <div><label for="weight">체중 (kg)<span class="required-mark">*</span>:</label><input type="number" id="weight" name="weight" step="0.1" required></div>
        <div><label for="gender">성별<span class="required-mark">*</span>:</label><select id="gender" name="gender" required><option value="">선택하세요</option><option value="male">남성</option><option value="female">여성</option></select></div>
        <h2 class="section-title">위험 요인 체크</h2>
        <div class="checkbox-group"><input type="checkbox" id="familyDiabetes" name="riskFactors" value="familyDiabetes"> <label for="familyDiabetes">당뇨병 가족력 (부모, 형제자매)</label><br><input type="checkbox" id="sedentaryLifestyle" name="riskFactors" value="sedentaryLifestyle"> <label for="sedentaryLifestyle">좌식 생활 (하루 대부분 앉아있고, 규칙적인 운동 안 함)</label><br><input type="checkbox" id="highBloodPressure" name="riskFactors" value="highBloodPressure"> <label for="highBloodPressure">고혈압 진단 또는 혈압약 복용 중</label><br><input type="checkbox" id="dyslipidemia" name="riskFactors" value="dyslipidemia"> <label for="dyslipidemia">이상지질혈증(고지혈증) 진단 또는 약 복용 중</label><br><input type="checkbox" id="gestationalDiabetes" name="riskFactors" value="gestationalDiabetes" class="female-only"> <label for="gestationalDiabetes">과거 임신성 당뇨병 진단 경험 (여성)</label><br><input type="checkbox" id="pcos" name="riskFactors" value="pcos" class="female-only"> <label for="pcos">다낭성 난소 증후군 진단 경험 (여성)</label><br><input type="checkbox" id="sleepDeprivation" name="riskFactors" value="sleepDeprivation"> <label for="sleepDeprivation">만성적인 수면 부족 (평균 수면 시간 6시간 미만)</label><br><input type="checkbox" id="highCarbDiet" name="riskFactors" value="highCarbDiet"> <label for="highCarbDiet">고탄수화물/가공식품 위주의 식단</label><br><input type="checkbox" id="smoking" name="riskFactors" value="smoking"> <label for="smoking">흡연</label><br></div>
        <h2 class="section-title">주요 증상 체크</h2>
        <div class="checkbox-group"><input type="checkbox" id="postMealFatigue" name="symptoms" value="postMealFatigue"> <label for="postMealFatigue">식후 심한 피로감이나 졸음</label><br><input type="checkbox" id="sugarCravings" name="symptoms" value="sugarCravings"> <label for="sugarCravings">단 음식이나 탄수화물에 대한 강한 갈망</label><br><input type="checkbox" id="abdominalObesity" name="symptoms" value="abdominalObesity"> <label for="abdominalObesity">복부 비만 (허리둘레 증가)</label><br><input type="checkbox" id="frequentHunger" name="symptoms" value="frequentHunger"> <label for="frequentHunger">식사 후에도 금방 배고픔을 느낌</label><br><input type="checkbox" id="skinProblems" name="symptoms" value="skinProblems"> <label for="skinProblems">피부 문제 (예: 쥐젖, 여드름, 흑색극세포증 - 겨드랑이, 목뒤 등)</label><br><input type="checkbox" id="concentrationDifficulties" name="symptoms" value="concentrationDifficulties"> <label for="concentrationDifficulties">집중력 저하 및 머리가 맑지 않은 느낌</label><br><input type="checkbox" id="increasedThirst" name="symptoms" value="increasedThirst"> <label for="increasedThirst">잦은 갈증 또는 다뇨</label><br><input type="checkbox" id="tinglingSensation" name="symptoms" value="tinglingSensation"> <label for="tinglingSensation">손발 저림 또는 따끔거림 (뚜렷한 원인 없이)</label><br><input type="checkbox" id="chronicFatigue" name="symptoms" value="chronicFatigue"> <label for="chronicFatigue">만성적인 피로감 (충분히 자도 개운하지 않음)</label><br><input type="checkbox" id="frequentInfections" name="symptoms" value="frequentInfections"> <label for="frequentInfections">잦은 염증이나 감염 (예: 질염, 방광염, 피부 감염 등)</label><br></div>
        <h2 class="section-title">한의학적 증상 체크 (습담 예측)</h2>
        <p style="text-align:center; margin-top:-15px; margin-bottom:20px; color:#6c757d;">인슐린 저항성의 한의학적 원인인 '습담(濕痰)'이 얼마나 쌓여있는지 확인합니다.</p>
        <div class="checkbox-group"><input type="checkbox" id="bodyHeaviness" name="orientalSymptoms" value="bodyHeaviness"> <label for="bodyHeaviness">몸이 천근만근 무겁고 자주 붓는다</label><br><input type="checkbox" id="indigestion" name="orientalSymptoms" value="indigestion"> <label for="indigestion">소화가 잘 안 되고 속이 더부룩하다</label><br><input type="checkbox" id="phlegm" name="orientalSymptoms" value="phlegm"> <label for="phlegm">아침에 가래가 많이 낀다</label><br><input type="checkbox" id="dizziness" name="orientalSymptoms" value="dizziness"> <label for="dizziness">머리가 맑지 않고 어지러울 때가 있다</label><br><input type="checkbox" id="jointPain" name="orientalSymptoms" value="jointPain"> <label for="jointPain">비가 오거나 습한 날씨에 관절이 쑤신다</label><br></div>
        
        <button type="button" id="analyzeBtn" class="btn" onclick="analyzeResults()">결과 분석하기</button>
    </form>
    
    <div id="results"></div>
</div>

<script>
    const clinicsData={서울:{성북구:[{name:"길음한의원",address:"성북구 길음로 10, 2층",contact:"02-943-1668",website:"https://goodnewshani.my.canva.site",websiteLabel:"홈페이지",naverBooking:"[길음한의원 네이버 예약 링크]"}]}};let currentChart=null;document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("gender"),t=document.querySelectorAll(".female-only");function n(){const n="female"===e.value;t.forEach(e=>{const t=e.querySelector('input[type="checkbox"]');t&&(t.disabled=!n,n||(t.checked=!1)),e.style.opacity=n?1:.5})}e.addEventListener("change",n),n()});

    // ▼▼▼▼▼ '다시 검사하기' 기능을 위한 함수 추가 ▼▼▼▼▼
    function resetTest() {
        document.getElementById('insulinSurvey').reset(); // 폼 내용 전체 초기화
        document.getElementById('results').innerHTML = ''; // 결과 영역 비우기
        window.scrollTo({ top: 0, behavior: 'smooth' }); // 페이지 맨 위로 부드럽게 스크롤
    }
    // ▲▲▲▲▲ 여기까지 추가 ▲▲▲▲▲

    function analyzeResults(){const e=document.getElementById("age"),t=document.getElementById("height"),n=document.getElementById("weight"),a=document.getElementById("gender"),l=parseInt(e.value),i=parseFloat(t.value),o=parseFloat(n.value),s=a.value;if(isNaN(l)||l<=0||isNaN(i)||i<=0||isNaN(o)||o<=0||!s)return void alert("나이, 키, 체중, 성별을 모두 올바르게 입력해주세요.");let d=0;let r="<h3>📊 검사 결과 분석</h3>";const c=i/100,m=o/(c*c);r+=`<p><strong>BMI:</strong> ${m.toFixed(2)} `,"male"===s?m<18.5?r+="(저체중)":m<23?r+="(정상체중)":m<25?(r+="(과체중)",d+=2):m<30?(r+="(경도비만)",d+=3):(r+="(중등도이상 비만)",d+=4):m<18.5?r+="(저체중)":m<24?r+="(정상체중)":m<28?(r+="(과체중)",d+=2):m<32?(r+="(경도비만)",d+=3):(r+="(중등도이상 비만)",d+=4),r+="</p>",l>=40&&l<50?(d+=1,r+="<p><strong>나이대:</strong> 40대 (주의 시작 구간 +1점)</p>"):l>=50&&(d+=2,r+="<p><strong>나이대:</strong> 50대 이상 (위험 증가 구간 +2점)</p>");let u="<h4>위험 요인</h4><ul>",h=0;document.querySelectorAll('input[name="riskFactors"]:checked').forEach(e=>{h++;let t=1;let n=e.nextElementSibling.textContent;"familyDiabetes"===e.value?(t=2,n+=" (+2점)"):"highBloodPressure"===e.value||"dyslipidemia"===e.value?(t=2,n+=" (+2점)"):"female"===s&&("gestationalDiabetes"===e.value||"pcos"===e.value)?(t=2,n+=" (+2점)"):"highCarbDiet"===e.value&&(t=2,n+=" (+2점)"),d+=t,u+=`<li>${n}</li>`}),u+=0===h?"<li>선택된 위험 요인 없음</li></ul>":"</ul>",r+=u;let g="<h4>주요 증상</h4><ul>",p=0;document.querySelectorAll('input[name="symptoms"]:checked').forEach(e=>{p++;let t=1,n=e.nextElementSibling.textContent;if("abdominalObesity"===e.value)t=2,n+=" (+2점)";else if("skinProblems"===e.value){const e=item.nextElementSibling.textContent;e.includes("흑색극세포증")?(t=3,n=e+" (+3점)"):(t=1,n=e+" (+1점)")}else"sugarCravings"===e.value||"postMealFatigue"===e.value?(t=2,n+=" (+2점)"):n+=" (+1점)";d+=t,g+=`<li>${n}</li>`}),g+=0===p?"<li>선택된 주요 증상 없음</li></ul>":"</ul>",r+=g;let b="<h4>한의학적 습담(濕痰) 분석</h4><ul>",v=0,f=0;document.querySelectorAll('input[name="orientalSymptoms"]:checked').forEach(e=>{v++,f+=2,b+=`<li>${e.nextElementSibling.textContent}</li>`}),d+=f,b+=0===v?"<li>선택된 한의학적 증상 없음</li>":v>=3?'<li><strong style="color:#dc3545;">한의학적 소견:</strong> 다수의 증상으로 보아 체내 노폐물인 <strong>습담(濕痰)</strong>이 많을 가능성이 높습니다. 이는 인슐린 저항성을 악화시키는 주요 원인이므로, 한의원에서 정확한 진단과 치료를 받는 것을 권장합니다.</li>':"",b+="</ul>",r+=b,r+=`<hr><p style="font-size:1.2em;"><strong>총 점수: ${d}점</strong></p>`;let y="";d<5?y="<span class='risk-low'>낮음</span>":d<10?y="<span class='risk-moderate'>주의</span>":d<15?y="<span class='risk-high'>높음</span>":y="<span class='risk-high'>매우 높음</span>",r+=`<p style="font-size:1.2em;"><strong>최종 위험도: ${y}</strong></p><p>${getRiskDescription(d)}</p>`;const k=document.getElementById("results");k.innerHTML=`<canvas id="resultChart" style="max-width: 100%; margin: 0 auto 25px auto; display: block;"></canvas><div id="analysisTextContainer"></div>`,document.getElementById("analysisTextContainer").innerHTML=r,drawResultChart(d),initializeClinicFinder(k)}function getRiskDescription(e){return e<5?"현재 인슐린 저항성 위험이 낮아 보입니다. 건강한 생활 습관을 유지하세요.":e<10?"인슐린 저항성 위험에 주의가 필요합니다. 식습관과 운동 등 생활 습관 개선을 고려해보세요.":e<15?"인슐린 저항성 위험이 높은 편입니다. 생활 습관 개선과 함께 전문가와 상담을 받는 것을 적극 권장합니다.":"인슐린 저항성 위험이 매우 높습니다. 반드시 전문가와 상담하여 정확한 진단과 관리를 받으시길 바랍니다."}function getRiskColor(e){return e<5?"rgba(40, 167, 69, 0.8)":e<10?"rgba(253, 126, 20, 0.8)":"rgba(220, 53, 69, 0.8)"}function drawResultChart(e){currentChart&&currentChart.destroy();const t=document.getElementById("resultChart").getContext("2d");currentChart=new Chart(t,{type:"bar",data:{labels:["나의 위험도 점수"],datasets:[{label:"점수",data:[e],backgroundColor:[getRiskColor(e)],borderColor:[getRiskColor(e)],borderWidth:1,borderRadius:5,barPercentage:.4}]},options:{indexAxis:"y",scales:{x:{beginAtZero:!0,max:Math.max(25,e+5)},y:{ticks:{font:{size:14,weight:"bold"}}}},plugins:{legend:{display:!1},title:{display:!0,text:"인슐린 저항성 위험도",font:{size:18}}}}})}
    
    function initializeClinicFinder(e){
        // ▼▼▼▼▼ 기존 한의원 추천 섹션 생성 후, 마지막에 버튼 추가하는 로직으로 수정 ▼▼▼▼▼
        let recommendationsDiv = document.getElementById('clinicRecommendations');
        if (!recommendationsDiv) {
            recommendationsDiv = document.createElement('div');
            recommendationsDiv.id = 'clinicRecommendations';
            e.appendChild(recommendationsDiv);
        }
        recommendationsDiv.innerHTML = `<h3>전문 한의원 상담 안내</h3><p>보다 전문적이고 자세한 내용은 설문 결과와 관계 없이, 아래 지역별 거점 한의원을 방문하여 심층적인 진료 및 상담을 받아보시는 것을 권해드립니다.</p><div id="majorRegionSelector" class="region-selector"></div><div id="subRegionSelector" class="region-selector" style="margin-top:15px; display:none;"></div><div id="clinicDisplay" style="margin-top:20px;"></div>`;
        
        const n=document.getElementById("majorRegionSelector");for(const e in clinicsData){const a=document.createElement("button");a.className="btn",a.textContent=e,a.onclick=()=>showSubRegions(e),n.appendChild(a)}

        // 최종 액션 버튼 컨테이너 추가
        const actionButtonDiv = document.createElement('div');
        actionButtonDiv.className = 'action-buttons';
        actionButtonDiv.innerHTML = `
            <button type="button" class="btn btn-reset" onclick="resetTest()">다시 검사해보기</button>
            <a href="https://goodnewshani.my.canva.site/" class="btn btn-gohome">홈페이지로 돌아가기</a>
        `;
        e.appendChild(actionButtonDiv);
        // ▲▲▲▲▲ 여기까지 수정 ▲▲▲▲▲
    }
    
    function showSubRegions(e){document.querySelectorAll("#majorRegionSelector button").forEach(t=>{t.classList.toggle("active",t.textContent===e)});const t=document.getElementById("subRegionSelector"),n=document.getElementById("clinicDisplay");t.innerHTML="",n.innerHTML="",t.style.display="block";const a=clinicsData[e];for(const e in a){const l=document.createElement("button");l.className="btn",l.textContent=e,l.onclick=()=>showClinicDetails(majorRegionName,e),t.appendChild(l)}}function showClinicDetails(e,t){document.querySelectorAll("#subRegionSelector button").forEach(n=>{n.classList.toggle("active",n.textContent===t)});const n=document.getElementById("clinicDisplay");n.innerHTML="";const a=clinicsData?.[e]?.[t]||[];a.forEach(e=>{const t=document.createElement("div");t.className="clinic-info-wrapper";const a=document.createElement("div");a.className="clinic-info";let l=`<h5>${e.name}</h5><p><strong>주소:</strong> ${e.address}</p><p><strong>연락처:</strong> ${e.contact}</p>`;e.website&&(l+=`<p><strong>${e.websiteLabel}:</strong> <a href="${e.website}" target="_blank">${e.website.replace(/^(https?:\/\/)?(www\.)?/,"")}</a></p>`),e.naverBooking&&(l+=`<a href="${e.naverBooking}" target="_blank" class="btn" style="background-color:#2DB400; color:white; padding:8px 12px; font-size:0.9em; margin-top:10px; display:inline-block; width:auto;">네이버 예약</a>`),a.innerHTML=l,t.appendChild(a),n.appendChild(t)})}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê¸¸ìŒí•œì˜ì› | ì¸ìŠë¦° ì €í•­ì„± ìê°€ì§„ë‹¨</title>
    <meta name="description" content="ê¸¸ìŒí•œì˜ì›ì—ì„œ ì œê³µí•˜ëŠ” ì¸ìŠë¦° ì €í•­ì„± ìê°€ì§„ë‹¨ í…ŒìŠ¤íŠ¸. ì‹í›„ í”¼ë¡œê°, ë³µë¶€ë¹„ë§Œ, ë§Œì„±í”¼ë¡œ ë“± ë‚´ ëª¸ì˜ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  í•œì˜í•™ì  ì›ì¸ê³¼ ê´€ë¦¬ë²•ê¹Œì§€ ì•Œì•„ë³´ì„¸ìš”.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #fbf9f4;
            color: #3b3b3b;
        }
        .header {
            text-align: center;
            padding: 20px 10px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        /* â–¼â–¼â–¼â–¼â–¼ ë¡œê³  ëŒ€ì‹  ë“¤ì–´ê°ˆ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ â–¼â–¼â–¼â–¼â–¼ */
        .header-title {
            color: #5a6e5a;
            font-size: 1.5em;
            font-weight: bold;
            text-decoration: none;
        }
        .container {
            background: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            max-width: 800px;
            margin: 30px auto;
        }
        h1, h2, h3, h4, h5 { color: #3b3b3b; }
        h1 { text-align: center; color: #5a6e5a; margin-bottom: 25px; }
        .section-title { font-size: 1.6em; color: #5a6e5a; border-bottom: 2px solid #5a6e5a; padding-bottom: 8px; margin-top: 35px; margin-bottom: 25px; }
        
        button, .btn {
            color: white;
            padding: 14px 22px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease;
            display: block;
            width: 100%;
            margin-top: 20px;
            box-sizing: border-box;
            text-align: center;
            text-decoration: none;
        }
        #analyzeBtn { background-color: #5a6e5a; }
        #analyzeBtn:hover { background-color: #4a5c4a; }

        .region-selector button {
            background-color: #87CEEB; /* í•˜ëŠ˜ìƒ‰ ê³„ì—´ */
            color: #ffffff;
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 10px 15px;
            font-size: 0.95em;
        }
        .region-selector button.active {
            background-color: #5F9EA0; /* ì„ íƒ ì‹œ ë” ì§„í•œ í•˜ëŠ˜ìƒ‰ */
            font-weight: bold;
        }
        .clinic-info-wrapper {
             margin-bottom: 18px;
        }
        .clinic-info {
            padding: 15px;
            border-left: 4px solid #a5d6a7;
            background-color: #ffffff;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.07);
        }
        .clinic-info h5 { margin-top: 0; margin-bottom: 10px; font-size: 1.1em; color: #388e3c; }
        .clinic-info p { margin: 6px 0; font-size: 0.95em; color: #424242; }
        .clinic-info strong { color: #212121; }
        .clinic-info a { color: #007bff; text-decoration: none; font-weight: bold; }
        .clinic-info a:hover { text-decoration: underline; }


        .action-buttons {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        .action-buttons .btn {
            width: auto;
            flex-grow: 1;
            padding: 12px 20px;
            font-size: 1em;
        }
        .btn-gohome {
            background-color: #5a6e5a;
            color: #ffffff;
            border: 1px solid #5a6e5a;
        }
        .btn-reset {
            background-color: #ffffff;
            color: #5a6e5a;
            border: 1px solid #5a6e5a;
        }

        #results { margin-top: 30px; padding: 25px; background-color: #f7f7f7; border-left: 6px solid #5a6e5a; border-radius: 5px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #495057; }
        input[type="text"], input[type="number"], select { width: 100%; padding: 12px; margin-bottom: 18px; border: 1px solid #ced4da; border-radius: 5px; box-sizing: border-box; font-size: 1em; }
        input[type="checkbox"] { margin-right: 10px; vertical-align: middle; }
        .checkbox-group label { font-weight: normal; display: inline-block; margin-bottom: 10px; cursor: pointer; }
        #results ul { padding-left: 20px; list-style: disc; }
        .warning { color: #856404; font-weight: bold; margin-bottom: 20px; padding: 15px; background-color: #fff3cd; border: 1px solid #ffeeba; border-radius: 5px; text-align: center; }
        .risk-low { color: #28a745; font-weight: bold; }
        .risk-moderate { color: #fd7e14; font-weight: bold; }
        .risk-high { color: #dc3545; font-weight: bold; }
        .required-mark { color: #dc3545; margin-left: 3px;}
    </style>
</head>
<body>

<div class="header">
    <a href="https://goodnewshani.my.canva.site/" class="header-title">ê¸¸ìŒí•œì˜ì›</a>
</div>

<div class="container">
    <h1>ì¸ìŠë¦° ì €í•­ì„± ìê°€ í…ŒìŠ¤íŠ¸</h1>
    <p class="warning"><strong>ì£¼ì˜:</strong> ì´ ì„¤ë¬¸ì€ ì˜í•™ì  ì§„ë‹¨ì„ ëŒ€ì²´í•  ìˆ˜ ì—†ìœ¼ë©°, ì°¸ê³ ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©í•´ì£¼ì‹­ì‹œì˜¤. ê±´ê°• ë¬¸ì œë‚˜ ìš°ë ¤ ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë°˜ë“œì‹œ <strong>í•œì˜ì‚¬ ë˜ëŠ” ì˜ì‚¬</strong>ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>
    
    <form id="insulinSurvey">
        <h2 class="section-title">ê¸°ë³¸ ì •ë³´</h2>
        <div><label for="age">ë‚˜ì´ (ì„¸)<span class="required-mark">*</span>:</label><input type="number" id="age" name="age" required></div>
        <div><label for="height">í‚¤ (cm)<span class="required-mark">*</span>:</label><input type="number" id="height" name="height" step="0.1" required></div>
        <div><label for="weight">ì²´ì¤‘ (kg)<span class="required-mark">*</span>:</label><input type="number" id="weight" name="weight" step="0.1" required></div>
        <div><label for="gender">ì„±ë³„<span class="required-mark">*</span>:</label><select id="gender" name="gender" required><option value="">ì„ íƒí•˜ì„¸ìš”</option><option value="male">ë‚¨ì„±</option><option value="female">ì—¬ì„±</option></select></div>
        <h2 class="section-title">ìœ„í—˜ ìš”ì¸ ì²´í¬</h2>
        <div class="checkbox-group"><input type="checkbox" id="familyDiabetes" name="riskFactors" value="familyDiabetes"> <label for="familyDiabetes">ë‹¹ë‡¨ë³‘ ê°€ì¡±ë ¥ (ë¶€ëª¨, í˜•ì œìë§¤)</label><br><input type="checkbox" id="sedentaryLifestyle" name="riskFactors" value="sedentaryLifestyle"> <label for="sedentaryLifestyle">ì¢Œì‹ ìƒí™œ (í•˜ë£¨ ëŒ€ë¶€ë¶„ ì•‰ì•„ìˆê³ , ê·œì¹™ì ì¸ ìš´ë™ ì•ˆ í•¨)</label><br><input type="checkbox" id="highBloodPressure" name="riskFactors" value="highBloodPressure"> <label for="highBloodPressure">ê³ í˜ˆì•• ì§„ë‹¨ ë˜ëŠ” í˜ˆì••ì•½ ë³µìš© ì¤‘</label><br><input type="checkbox" id="dyslipidemia" name="riskFactors" value="dyslipidemia"> <label for="dyslipidemia">ì´ìƒì§€ì§ˆí˜ˆì¦(ê³ ì§€í˜ˆì¦) ì§„ë‹¨ ë˜ëŠ” ì•½ ë³µìš© ì¤‘</label><br><input type="checkbox" id="gestationalDiabetes" name="riskFactors" value="gestationalDiabetes" class="female-only"> <label for="gestationalDiabetes">ê³¼ê±° ì„ì‹ ì„± ë‹¹ë‡¨ë³‘ ì§„ë‹¨ ê²½í—˜ (ì—¬ì„±)</label><br><input type="checkbox" id="pcos" name="riskFactors" value="pcos" class="female-only"> <label for="pcos">ë‹¤ë‚­ì„± ë‚œì†Œ ì¦í›„êµ° ì§„ë‹¨ ê²½í—˜ (ì—¬ì„±)</label><br><input type="checkbox" id="sleepDeprivation" name="riskFactors" value="sleepDeprivation"> <label for="sleepDeprivation">ë§Œì„±ì ì¸ ìˆ˜ë©´ ë¶€ì¡± (í‰ê·  ìˆ˜ë©´ ì‹œê°„ 6ì‹œê°„ ë¯¸ë§Œ)</label><br><input type="checkbox" id="highCarbDiet" name="riskFactors" value="highCarbDiet"> <label for="highCarbDiet">ê³ íƒ„ìˆ˜í™”ë¬¼/ê°€ê³µì‹í’ˆ ìœ„ì£¼ì˜ ì‹ë‹¨</label><br><input type="checkbox" id="smoking" name="riskFactors" value="smoking"> <label for="smoking">í¡ì—°</label><br></div>
        <h2 class="section-title">ì£¼ìš” ì¦ìƒ ì²´í¬</h2>
        <div class="checkbox-group"><input type="checkbox" id="postMealFatigue" name="symptoms" value="postMealFatigue"> <label for="postMealFatigue">ì‹í›„ ì‹¬í•œ í”¼ë¡œê°ì´ë‚˜ ì¡¸ìŒ</label><br><input type="checkbox" id="sugarCravings" name="symptoms" value="sugarCravings"> <label for="sugarCravings">ë‹¨ ìŒì‹ì´ë‚˜ íƒ„ìˆ˜í™”ë¬¼ì— ëŒ€í•œ ê°•í•œ ê°ˆë§</label><br><input type="checkbox" id="abdominalObesity" name="symptoms" value="abdominalObesity"> <label for="abdominalObesity">ë³µë¶€ ë¹„ë§Œ (í—ˆë¦¬ë‘˜ë ˆ ì¦ê°€)</label><br><input type="checkbox" id="frequentHunger" name="symptoms" value="frequentHunger"> <label for="frequentHunger">ì‹ì‚¬ í›„ì—ë„ ê¸ˆë°© ë°°ê³ í””ì„ ëŠë‚Œ</label><br><input type="checkbox" id="skinProblems" name="symptoms" value="skinProblems"> <label for="skinProblems">í”¼ë¶€ ë¬¸ì œ (ì˜ˆ: ì¥ì –, ì—¬ë“œë¦„, í‘ìƒ‰ê·¹ì„¸í¬ì¦ - ê²¨ë“œë‘ì´, ëª©ë’¤ ë“±)</label><br><input type="checkbox" id="concentrationDifficulties" name="symptoms" value="concentrationDifficulties"> <label for="concentrationDifficulties">ì§‘ì¤‘ë ¥ ì €í•˜ ë° ë¨¸ë¦¬ê°€ ë§‘ì§€ ì•Šì€ ëŠë‚Œ</label><br><input type="checkbox" id="increasedThirst" name="symptoms" value="increasedThirst"> <label for="increasedThirst">ì¦ì€ ê°ˆì¦ ë˜ëŠ” ë‹¤ë‡¨</label><br><input type="checkbox" id="tinglingSensation" name="symptoms" value="tinglingSensation"> <label for="tinglingSensation">ì†ë°œ ì €ë¦¼ ë˜ëŠ” ë”°ë”ê±°ë¦¼ (ëšœë ·í•œ ì›ì¸ ì—†ì´)</label><br><input type="checkbox" id="chronicFatigue" name="symptoms" value="chronicFatigue"> <label for="chronicFatigue">ë§Œì„±ì ì¸ í”¼ë¡œê° (ì¶©ë¶„íˆ ìë„ ê°œìš´í•˜ì§€ ì•ŠìŒ)</label><br><input type="checkbox" id="frequentInfections" name="symptoms" value="frequentInfections"> <label for="frequentInfections">ì¦ì€ ì—¼ì¦ì´ë‚˜ ê°ì—¼ (ì˜ˆ: ì§ˆì—¼, ë°©ê´‘ì—¼, í”¼ë¶€ ê°ì—¼ ë“±)</label><br></div>
        <h2 class="section-title">í•œì˜í•™ì  ì¦ìƒ ì²´í¬ (ìŠµë‹´ ì˜ˆì¸¡)</h2>
        <p style="text-align:center; margin-top:-15px; margin-bottom:20px; color:#6c757d;">ì¸ìŠë¦° ì €í•­ì„±ì˜ í•œì˜í•™ì  ì›ì¸ì¸ 'ìŠµë‹´(æ¿•ç—°)'ì´ ì–¼ë§ˆë‚˜ ìŒ“ì—¬ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
        <div class="checkbox-group"><input type="checkbox" id="bodyHeaviness" name="orientalSymptoms" value="bodyHeaviness"> <label for="bodyHeaviness">ëª¸ì´ ì²œê·¼ë§Œê·¼ ë¬´ê²ê³  ìì£¼ ë¶“ëŠ”ë‹¤</label><br><input type="checkbox" id="indigestion" name="orientalSymptoms" value="indigestion"> <label for="indigestion">ì†Œí™”ê°€ ì˜ ì•ˆ ë˜ê³  ì†ì´ ë”ë¶€ë£©í•˜ë‹¤</label><br><input type="checkbox" id="phlegm" name="orientalSymptoms" value="phlegm"> <label for="phlegm">ì•„ì¹¨ì— ê°€ë˜ê°€ ë§ì´ ë‚€ë‹¤</label><br><input type="checkbox" id="dizziness" name="orientalSymptoms" value="dizziness"> <label for="dizziness">ë¨¸ë¦¬ê°€ ë§‘ì§€ ì•Šê³  ì–´ì§€ëŸ¬ìš¸ ë•Œê°€ ìˆë‹¤</label><br><input type="checkbox" id="jointPain" name="orientalSymptoms" value="jointPain"> <label for="jointPain">ë¹„ê°€ ì˜¤ê±°ë‚˜ ìŠµí•œ ë‚ ì”¨ì— ê´€ì ˆì´ ì‘¤ì‹ ë‹¤</label><br></div>
        
        <button type="button" id="analyzeBtn" class="btn" onclick="analyzeResults()">ê²°ê³¼ ë¶„ì„í•˜ê¸°</button>
    </form>
    
    <div id="results"></div>
</div>

<script>
    // â–¼â–¼â–¼â–¼â–¼ ëˆ„ë½ë˜ì—ˆë˜ ëª¨ë“  í•œì˜ì› ë°ì´í„°ë¥¼ ë³µêµ¬í–ˆìŠµë‹ˆë‹¤ â–¼â–¼â–¼â–¼â–¼
    const clinicsData = {
        "ì„œìš¸": {
            "ì„±ë¶êµ¬": [{
                name: "ê¸¸ìŒí•œì˜ì›",
                address: "ì„±ë¶êµ¬ ê¸¸ìŒë¡œ 10, 2ì¸µ",
                contact: "02-943-1668",
                website: "https://goodnewshani.my.canva.site",
                websiteLabel: "í™ˆí˜ì´ì§€",
                naverBooking: "[ê¸¸ìŒí•œì˜ì› ë„¤ì´ë²„ ì˜ˆì•½ ë§í¬]"
            }],
            "ì¤‘ë‘êµ¬": [{
                name: "ë°”ë¡œìœ í•œì˜ì›",
                address: "ì„œìš¸ ì¤‘ë‘êµ¬ ì‚¬ê°€ì •ë¡œ52ê¸¸ 22 ê´‘í˜„ë¹Œë”© 2ì¸µ, 5ì¸µ",
                contact: "0507-1314-8905",
                website: "https://www.baroyou.net/",
                websiteLabel: "í™ˆí˜ì´ì§€"
            }],
            "ê°•ì„œêµ¬": [{
                name: "ë‹¤ê°€ì˜¨í•œì˜ì›",
                address: "ì„œìš¸ ê°•ì„œêµ¬ ê°•ì„œë¡œ 43-17 ì˜¤ê±°ë‹‰ìŠ¤íƒ€ì›Œ 202í˜¸",
                contact: "02-2068-1075",
                website: "https://blog.naver.com/jenniesjh2",
                websiteLabel: "ë¸”ë¡œê·¸"
            }],
            "ê°•ë‚¨êµ¬": [{
                name: "ê²½í¬ì§„í‰í•œì˜ì›",
                address: "ì„œìš¸ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 333 ì§€í•˜1ì¸µ",
                contact: "0507-1376-6603",
                website: "https://blog.naver.com/david3140",
                websiteLabel: "ë¸”ë¡œê·¸"
            }]
        }
    };
    
    let currentChart = null;

    document.addEventListener("DOMContentLoaded", function() {
        const genderSelect = document.getElementById("gender");
        const femaleOnlyElements = document.querySelectorAll(".female-only");

        function toggleFemaleSpecificFields() {
            const isFemale = genderSelect.value === 'female';
            femaleOnlyElements.forEach(el => {
                const checkbox = el.querySelector('input[type="checkbox"]');
                if (checkbox) {
                    checkbox.disabled = !isFemale;
                    if (!isFemale) {
                        checkbox.checked = false;
                    }
                }
                el.style.opacity = isFemale ? 1 : 0.5;
            });
        }
        genderSelect.addEventListener('change', toggleFemaleSpecificFields);
        toggleFemaleSpecificFields();
    });

    function resetTest() {
        document.getElementById('insulinSurvey').reset();
        document.getElementById('results').innerHTML = '';
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function analyzeResults() {
        const ageInput = document.getElementById('age');
        const heightInput = document.getElementById('height');
        const weightInput = document.getElementById('weight');
        const genderInput = document.getElementById('gender');

        const age = parseInt(ageInput.value);
        const height = parseFloat(heightInput.value);
        const weight = parseFloat(weightInput.value);
        const gender = genderInput.value;

        if (isNaN(age) || age <= 0 || isNaN(height) || height <= 0 || isNaN(weight) || weight <= 0 || !gender) {
            alert("ë‚˜ì´, í‚¤, ì²´ì¤‘, ì„±ë³„ì„ ëª¨ë‘ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        let score = 0;
        let analysisText = "<h3>ğŸ“Š ê²€ì‚¬ ê²°ê³¼ ë¶„ì„</h3>";
        
        const heightInMeters = height / 100;
        const bmi = weight / (heightInMeters * heightInMeters);
        analysisText += `<p><strong>BMI:</strong> ${bmi.toFixed(2)} `;
        if (bmi < 18.5) { analysisText += "(ì €ì²´ì¤‘)"; }
        else if (bmi < 23) { analysisText += "(ì •ìƒì²´ì¤‘)"; }
        else if (bmi < 25) { analysisText += "(ê³¼ì²´ì¤‘)"; score += 2; }
        else if (bmi < 30) { analysisText += "(ê²½ë„ë¹„ë§Œ)"; score += 3; }
        else { analysisText += "(ì¤‘ë“±ë„ì´ìƒ ë¹„ë§Œ)"; score += 4; }
        analysisText += "</p>";

        if (age >= 40 && age < 50) { score += 1; analysisText += "<p><strong>ë‚˜ì´ëŒ€:</strong> 40ëŒ€ (ì£¼ì˜ ì‹œì‘ êµ¬ê°„ +1ì )</p>"; }
        else if (age >= 50) { score += 2; analysisText += "<p><strong>ë‚˜ì´ëŒ€:</strong> 50ëŒ€ ì´ìƒ (ìœ„í—˜ ì¦ê°€ êµ¬ê°„ +2ì )</p>"; }

        let riskFactorDetails = "<h4>ìœ„í—˜ ìš”ì¸</h4><ul>";
        let riskFactorCount = 0;
        document.querySelectorAll('input[name="riskFactors"]:checked').forEach(item => {
            riskFactorCount++;
            let factorWeight = 1;
            let factorText = item.nextElementSibling.textContent;
            if (item.value === 'familyDiabetes' || item.value === 'highBloodPressure' || item.value === 'dyslipidemia' || item.value === 'highCarbDiet') {
                factorWeight = 2; factorText += " (+2ì )";
            } else if (gender === 'female' && (item.value === 'gestationalDiabetes' || item.value === 'pcos')) {
                factorWeight = 2; factorText += " (+2ì )";
            } else {
                 factorText += " (+1ì )";
            }
            score += factorWeight;
            riskFactorDetails += `<li>${factorText}</li>`;
        });
        riskFactorDetails += (riskFactorCount === 0) ? "<li>ì„ íƒëœ ìœ„í—˜ ìš”ì¸ ì—†ìŒ</li></ul>" : "</ul>";
        analysisText += riskFactorDetails;
        
        let symptomDetails = "<h4>ì£¼ìš” ì¦ìƒ</h4><ul>";
        let symptomCount = 0;
        document.querySelectorAll('input[name="symptoms"]:checked').forEach(item => {
            symptomCount++;
            let symptomWeight = 1;
            let symptomText = item.nextElementSibling.textContent;
            if (item.value === 'abdominalObesity' || item.value === 'sugarCravings' || item.value === 'postMealFatigue') {
                symptomWeight = 2; symptomText += " (+2ì )";
            } else if (item.value === 'skinProblems') {
                const skinProblemLabel = item.nextElementSibling.textContent;
                if (skinProblemLabel.includes("í‘ìƒ‰ê·¹ì„¸í¬ì¦")) {
                    symptomWeight = 3; symptomText = skinProblemLabel + " (+3ì )";
                } else {
                    symptomWeight = 1; symptomText = skinProblemLabel + " (+1ì )";
                }
            } else {
                symptomText += " (+1ì )";
            }
            score += symptomWeight;
            symptomDetails += `<li>${symptomText}</li>`;
        });
        symptomDetails += (symptomCount === 0) ? "<li>ì„ íƒëœ ì£¼ìš” ì¦ìƒ ì—†ìŒ</li></ul>" : "</ul>";
        analysisText += symptomDetails;

        let orientalSymptomDetails = "<h4>í•œì˜í•™ì  ìŠµë‹´(æ¿•ç—°) ë¶„ì„</h4><ul>";
        let orientalSymptomCount = 0;
        let orientalScore = 0;
        document.querySelectorAll('input[name="orientalSymptoms"]:checked').forEach(item => {
            orientalSymptomCount++;
            orientalScore += 2;
            orientalSymptomDetails += `<li>${item.nextElementSibling.textContent}</li>`;
        });
        score += orientalScore;
        if (orientalSymptomCount === 0) {
            orientalSymptomDetails += "<li>ì„ íƒëœ í•œì˜í•™ì  ì¦ìƒ ì—†ìŒ</li>";
        } else if (orientalSymptomCount >= 3) {
            orientalSymptomDetails += `<li><strong style="color:#dc3545;">í•œì˜í•™ì  ì†Œê²¬:</strong> ë‹¤ìˆ˜ì˜ ì¦ìƒìœ¼ë¡œ ë³´ì•„ ì²´ë‚´ ë…¸íë¬¼ì¸ <strong>ìŠµë‹´(æ¿•ç—°)</strong>ì´ ë§ì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. ì´ëŠ” ì¸ìŠë¦° ì €í•­ì„±ì„ ì•…í™”ì‹œí‚¤ëŠ” ì£¼ìš” ì›ì¸ì´ë¯€ë¡œ, í•œì˜ì›ì—ì„œ ì •í™•í•œ ì§„ë‹¨ê³¼ ì¹˜ë£Œë¥¼ ë°›ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.</li>`;
        }
        orientalSymptomDetails += "</ul>";
        analysisText += orientalSymptomDetails;

        analysisText += `<hr><p style="font-size:1.2em;"><strong>ì´ ì ìˆ˜: ${score}ì </strong></p>`;
        let riskLevelText = "";
        if (score < 5) { riskLevelText = "<span class='risk-low'>ë‚®ìŒ</span>"; }
        else if (score < 10) { riskLevelText = "<span class='risk-moderate'>ì£¼ì˜</span>"; }
        else if (score < 15) { riskLevelText = "<span class='risk-high'>ë†’ìŒ</span>"; }
        else { riskLevelText = "<span class='risk-high'>ë§¤ìš° ë†’ìŒ</span>"; }
        analysisText += `<p style="font-size:1.2em;"><strong>ìµœì¢… ìœ„í—˜ë„: ${riskLevelText}</strong></p><p>${getRiskDescription(score)}</p>`;
        
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = `<canvas id="resultChart" style="max-width: 100%; margin: 0 auto 25px auto; display: block;"></canvas><div id="analysisTextContainer"></div>`;
        document.getElementById('analysisTextContainer').innerHTML = analysisText;
        
        drawResultChart(score);
        initializeClinicFinder(resultsDiv);
    }

    function getRiskDescription(score) {
        if (score < 5) return "í˜„ì¬ ì¸ìŠë¦° ì €í•­ì„± ìœ„í—˜ì´ ë‚®ì•„ ë³´ì…ë‹ˆë‹¤. ê±´ê°•í•œ ìƒí™œ ìŠµê´€ì„ ìœ ì§€í•˜ì„¸ìš”.";
        if (score < 10) return "ì¸ìŠë¦° ì €í•­ì„± ìœ„í—˜ì— ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì‹ìŠµê´€ê³¼ ìš´ë™ ë“± ìƒí™œ ìŠµê´€ ê°œì„ ì„ ê³ ë ¤í•´ë³´ì„¸ìš”.";
        if (score < 15) return "ì¸ìŠë¦° ì €í•­ì„± ìœ„í—˜ì´ ë†’ì€ í¸ì…ë‹ˆë‹¤. ìƒí™œ ìŠµê´€ ê°œì„ ê³¼ í•¨ê»˜ ì „ë¬¸ê°€ì™€ ìƒë‹´ì„ ë°›ëŠ” ê²ƒì„ ì ê·¹ ê¶Œì¥í•©ë‹ˆë‹¤.";
        return "ì¸ìŠë¦° ì €í•­ì„± ìœ„í—˜ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì—¬ ì •í™•í•œ ì§„ë‹¨ê³¼ ê´€ë¦¬ë¥¼ ë°›ìœ¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤.";
    }

    function getRiskColor(score) {
        if (score < 5) return 'rgba(40, 167, 69, 0.8)';
        if (score < 10) return 'rgba(253, 126, 20, 0.8)';
        return 'rgba(220, 53, 69, 0.8)';
    }

    function drawResultChart(score) {
        if (currentChart) {
            currentChart.destroy();
        }
        const ctx = document.getElementById('resultChart').getContext('2d');
        currentChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['ë‚˜ì˜ ìœ„í—˜ë„ ì ìˆ˜'],
                datasets: [{
                    label: 'ì ìˆ˜',
                    data: [score],
                    backgroundColor: [getRiskColor(score)],
                    borderColor: [getRiskColor(score)],
                    borderWidth: 1,
                    borderRadius: 5,
                    barPercentage: 0.4
                }]
            },
            options: {
                indexAxis: 'y',
                scales: {
                    x: { beginAtZero: true, max: Math.max(25, score + 5) },
                    y: { ticks: { font: { size: 14, weight: 'bold' } } }
                },
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'ì¸ìŠë¦° ì €í•­ì„± ìœ„í—˜ë„', font: { size: 18 } }
                }
            }
        });
    }

    function initializeClinicFinder(resultsDiv) {
        let recommendationsDiv = document.getElementById('clinicRecommendations');
        if (recommendationsDiv) {
            recommendationsDiv.innerHTML = '';
        } else {
            recommendationsDiv = document.createElement('div');
            recommendationsDiv.id = 'clinicRecommendations';
            resultsDiv.appendChild(recommendationsDiv);
        }
        
        recommendationsDiv.innerHTML = `<h3>ì „ë¬¸ í•œì˜ì› ìƒë‹´ ì•ˆë‚´</h3><p>ë³´ë‹¤ ì „ë¬¸ì ì´ê³  ìì„¸í•œ ë‚´ìš©ì€ ì„¤ë¬¸ ê²°ê³¼ì™€ ê´€ê³„ ì—†ì´, ì•„ë˜ ì§€ì—­ë³„ ê±°ì  í•œì˜ì›ì„ ë°©ë¬¸í•˜ì—¬ ì‹¬ì¸µì ì¸ ì§„ë£Œ ë° ìƒë‹´ì„ ë°›ì•„ë³´ì‹œëŠ” ê²ƒì„ ê¶Œí•´ë“œë¦½ë‹ˆë‹¤.</p><div id="majorRegionSelector" class="region-selector"></div><div id="subRegionSelector" class="region-selector" style="margin-top:15px; display:none;"></div><div id="clinicDisplay" style="margin-top:20px;"></div>`;
        
        const majorRegionSelector = document.getElementById("majorRegionSelector");
        majorRegionSelector.innerHTML = ''; // ë²„íŠ¼ ì¤‘ë³µ ìƒì„± ë°©ì§€
        for (const majorRegion in clinicsData) {
            const button = document.createElement("button");
            button.className = "btn";
            button.textContent = majorRegion;
            button.onclick = () => showSubRegions(majorRegion);
            majorRegionSelector.appendChild(button);
        }

        const actionButtonDiv = document.createElement('div');
        actionButtonDiv.className = 'action-buttons';
        actionButtonDiv.innerHTML = `<button type="button" class="btn btn-reset" onclick="resetTest()">ë‹¤ì‹œ ê²€ì‚¬í•´ë³´ê¸°</button><a href="https://goodnewshani.my.canva.site/" class="btn btn-gohome">í™ˆí˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</a>`;
        resultsDiv.appendChild(actionButtonDiv);
    }

    function showSubRegions(majorRegion) {
        document.querySelectorAll("#majorRegionSelector button").forEach(btn => {
            btn.classList.toggle("active", btn.textContent === majorRegion);
        });
        const subRegionSelector = document.getElementById("subRegionSelector");
        const clinicDisplay = document.getElementById("clinicDisplay");
        subRegionSelector.innerHTML = "";
        clinicDisplay.innerHTML = "";
        subRegionSelector.style.display = "block";
        
        const subRegions = clinicsData[majorRegion];
        for (const subRegion in subRegions) {
            const button = document.createElement("button");
            button.className = "btn";
            button.textContent = subRegion;
            button.onclick = () => showClinicDetails(majorRegion, subRegion);
            subRegionSelector.appendChild(button);
        }
    }

    function showClinicDetails(majorRegion, subRegion) {
        document.querySelectorAll("#subRegionSelector button").forEach(btn => {
            btn.classList.toggle("active", btn.textContent === subRegion);
        });
        const clinicDisplay = document.getElementById("clinicDisplay");
        clinicDisplay.innerHTML = "";
        const clinics = clinicsData[majorRegion][subRegion] || [];
        clinics.forEach(clinic => {
            const clinicWrapper = document.createElement("div");
            clinicWrapper.className = "clinic-info-wrapper";
            const clinicDiv = document.createElement("div");
            clinicDiv.className = "clinic-info";
            let clinicInfoHTML = `<h5>${clinic.name}</h5><p><strong>ì£¼ì†Œ:</strong> ${clinic.address}</p><p><strong>ì—°ë½ì²˜:</strong> ${clinic.contact}</p>`;
            if (clinic.website) {
                clinicInfoHTML += `<p><strong>${clinic.websiteLabel}:</strong> <a href="${clinic.website}" target="_blank">${clinic.website.replace(/^(https?:\/\/)?(www\.)?/, "")}</a></p>`;
            }
            if (clinic.naverBooking && clinic.naverBooking !== "[ê¸¸ìŒí•œì˜ì› ë„¤ì´ë²„ ì˜ˆì•½ ë§í¬]") {
                clinicInfoHTML += `<a href="${clinic.naverBooking}" target="_blank" class="btn" style="background-color:#2DB400; color:white; padding:8px 12px; font-size:0.9em; margin-top:10px; display:inline-block; width:auto;">ë„¤ì´ë²„ ì˜ˆì•½</a>`;
            }
            clinicDiv.innerHTML = clinicInfoHTML;
            clinicWrapper.appendChild(clinicDiv);
            clinicDisplay.appendChild(clinicWrapper);
        });
    }
</script>

</body>
</html>
